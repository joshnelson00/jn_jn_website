{% extends 'index.html' %}
{% load static %}

{% block content %}
<div class="content">
    <h1>Edit Groups for {{ organization.name }}</h1>
    
    <div class="user-group-container-wrapper">
        {% for user in users_not_in_groups %}
        <div class="movable-user" id="user{{ user.id }}">{{ user.username }}</div>
        {% empty %}
        <p>No users available.</p>
        {% endfor %}
    </div>
    
    <div class="group-container-wrapper">
        <!-- Loop through each group associated with the organization -->
        {% for group in groups %}
        <div class="group-container">
            <!-- Make the group name editable -->
            <h2 contenteditable="true" class="editable-group-name">{{ group.name }}</h2>
            
            <div class="group-users">
                <h4>Group Members:</h4>
                {% for user in users_in_groups %}
                {% if user in group.user_groups.all %}
                <div class="movable-user" id="user{{ user.id }}">{{ user.username }}</div>
                {% endif %}
                {% endfor %}
            </div>
        </div>
        {% endfor %}
    </div>

    <!-- Only show the delete button if the logged-in user is the owner of the organization -->
    {% if organization.owner == request.user %}
    <form method="POST" action="{% url 'delete_organization' organization.id %}" onsubmit="return confirm('Are you sure you want to delete this organization?');">
        {% csrf_token %}
        <button type="submit" class="btn btn-danger">Delete Organization</button>
    </form>
    {% endif %}
</div>
{% endblock %}
